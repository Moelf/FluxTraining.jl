<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <!--     <link rel="icon" href="/favicon.png" /> -->
    <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta http-equiv="content-security-policy" content=""><title>FluxTraining.jl - Custom training loops</title>
	<link rel="stylesheet" href="/FluxTraining.jl/internal/assets/pages/__layout.svelte-1a98dd1d.css">
	<link rel="stylesheet" href="/FluxTraining.jl/internal/assets/pages/_version_/_...documentId_.svelte-dba02bca.css">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/start-8747b069.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/chunks/index-307525cc.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/chunks/singletons-5a54ffdc.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/chunks/paths-396f020f.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/pages/__layout.svelte-80f23352.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/pages/_version_/_...documentId_.svelte-78a89889.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/chunks/navigation-d32ded51.js">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;600&display=swap');
    </style>
</head>

<body>
    <div id="svelte">






<div class="flex flex-col lg:flex-row max-w-full" style="height: 100vh; width: 100%;">
	



<div class="header border-gray-200 flex flex-col w-full border-b-[1px] lg:sticky lg:top-0 lg:w-72 lg:[min-width:18rem;] lg:max-h-full lg:overflow-y-auto lg:overflow-x-clip lg:min-h-screen lg:h-screen lg:border-b-0 lg:border-r-[1px]"><div class="title flex flex-row items-center p-3"><span class="name content-center text-xl flex-grow font-bold"><a href="/FluxTraining.jl/dev/documents/README.md">FluxTraining.jl</a></span>
		<span class="openmenu cursor-pointer flex lg:hidden">
<svg data-carbon-icon="Menu24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24" preserveAspectRatio="xMidYMid meet" aria-hidden focusable="false"><path d="M3 18H21V19.5H3zM3 13.5H21V15H3zM3 9H21V10.5H3zM3 4.5H21V6H3z"></path>
    
  </svg></span></div>

	<div class="menu p-3 flex-col hidden [box-shadow:inset_0_0_8px_rgba(0,0,0,.1)] border-t-[1px] lg:flex lg:[box-shadow:none] lg:border-t-0 "><div class="group svelte-16loc5n"><div class="grouptitle svelte-16loc5n">Search</div>
			<div class="searchwidget svelte-1lm1fh6" style="width: 100%; flex-grow: 3">
	<div class="searchfield svelte-1lm1fh6">
<svg data-carbon-icon="Search20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" width="20" height="20" preserveAspectRatio="xMidYMid meet" style="fill:gray; display:inline" aria-hidden focusable="false"><path d="M29,27.5859l-7.5521-7.5521a11.0177,11.0177,0,1,0-1.4141,1.4141L27.5859,29ZM4,13a9,9,0,1,1,9,9A9.01,9.01,0,0,1,4,13Z"></path>
    
  </svg>
		<input type="text" placeholder="Search for text or code" style="margin-left: 4px; flex-grow: 2; outline:none; background: inherit;" class="svelte-1lm1fh6" value="">

			
			</div>
	
</div></div>
		<div class="group svelte-16loc5n"><div class="grouptitle svelte-16loc5n">Pages</div>
			<div class="ml-1 mr-1">
	<div><a class="link svelte-mg7szw" href="/FluxTraining.jl/dev/documents/README.md">Overview</a></div>
	<div><a class="link svelte-mg7szw" href="/FluxTraining.jl/dev/documents/docs/getting_started.md">Getting started</a></div>
	<div><a class="link svelte-mg7szw" href="/FluxTraining.jl/dev/documents/docs/features.md">Features</a></div><div class="groupcontainer svelte-mg7szw"><div class="groupname svelte-mg7szw">
<svg data-carbon-icon="CaretDownGlyph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 4" fill="currentColor" width="8" height="4" preserveAspectRatio="xMidYMid meet" style="display:inline; width: 8px" aria-hidden focusable="false"><path d="M8 0L4 4 0 0z"></path>
    
  </svg>
					<span class="pl-1">Tutorials</span></div>
				<div class="group svelte-mg7szw">
	<div><a class="link svelte-mg7szw" href="/FluxTraining.jl/dev/documents/docs/tutorials/mnist.ipynb">Train an image classifier</a></div>
	<div><a class="link svelte-mg7szw" href="/FluxTraining.jl/dev/documents/docs/callbacks/custom.md">Write a custom callback</a></div>
					</div>
			</div><div class="groupcontainer svelte-mg7szw"><div class="groupname svelte-mg7szw">
<svg data-carbon-icon="CaretDownGlyph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 4" fill="currentColor" width="8" height="4" preserveAspectRatio="xMidYMid meet" style="display:inline; width: 8px" aria-hidden focusable="false"><path d="M8 0L4 4 0 0z"></path>
    
  </svg>
					<span class="pl-1">How to</span></div>
				<div class="group svelte-mg7szw">
	<div><a class="link svelte-mg7szw" href="/FluxTraining.jl/dev/documents/docs/callbacks/usage.md">Use callbacks</a></div>
	<div><a class="link svelte-mg7szw" href="/FluxTraining.jl/dev/documents/docs/callbacks/tipstricks.md">Tips &amp; Tricks</a></div>
					</div>
			</div><div class="groupcontainer svelte-mg7szw"><div class="groupname svelte-mg7szw">
<svg data-carbon-icon="CaretDownGlyph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 4" fill="currentColor" width="8" height="4" preserveAspectRatio="xMidYMid meet" style="display:inline; width: 8px" aria-hidden focusable="false"><path d="M8 0L4 4 0 0z"></path>
    
  </svg>
					<span class="pl-1">Reference</span></div>
				<div class="group svelte-mg7szw">
	<div><a class="link svelte-mg7szw" href="/FluxTraining.jl/dev/references/FluxTraining">Module</a></div>
	<div><a class="link svelte-mg7szw" href="/FluxTraining.jl/dev/documents/docs/callbacks/reference.md">List of callbacks</a></div>
	<div><a class="link svelte-mg7szw" href="/FluxTraining.jl/dev/documents/docs/reference/training.md">Training loop API</a></div>
					</div>
			</div><div class="groupcontainer svelte-mg7szw"><div class="groupname svelte-mg7szw">
<svg data-carbon-icon="CaretDownGlyph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 4" fill="currentColor" width="8" height="4" preserveAspectRatio="xMidYMid meet" style="display:inline; width: 8px" aria-hidden focusable="false"><path d="M8 0L4 4 0 0z"></path>
    
  </svg>
					<span class="pl-1">Backround</span></div>
				<div class="group svelte-mg7szw">
	<div><a class="link svelte-mg7szw" href="/FluxTraining.jl/dev/documents/docs/tutorials/hyperparameters.md">Hyperparameter scheduling</a></div>
	<div><a class="link svelte-mg7szw" href="/FluxTraining.jl/dev/documents/docs/tutorials/training.md">Custom training loops</a></div>
					</div>
			</div></div></div>

		
		

		
		
		<div class="group svelte-16loc5n"><div class="grouptitle svelte-16loc5n">Links</div>
			<a href="https://github.com/FluxML/FluxTraining.jl" class="text-gray-600 hover:text-gray-900">
<svg data-carbon-icon="LogoGithub24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" width="24" height="24" preserveAspectRatio="xMidYMid meet" aria-hidden focusable="false"><path fill-rule="evenodd" d="M16,2a14,14,0,0,0-4.43,27.28c.7.13,1-.3,1-.67s0-1.21,0-2.38c-3.89.84-4.71-1.88-4.71-1.88A3.71,3.71,0,0,0,6.24,22.3c-1.27-.86.1-.85.1-.85A2.94,2.94,0,0,1,8.48,22.9a3,3,0,0,0,4.08,1.16,2.93,2.93,0,0,1,.88-1.87c-3.1-.36-6.37-1.56-6.37-6.92a5.4,5.4,0,0,1,1.44-3.76,5,5,0,0,1,.14-3.7s1.17-.38,3.85,1.43a13.3,13.3,0,0,1,7,0c2.67-1.81,3.84-1.43,3.84-1.43a5,5,0,0,1,.14,3.7,5.4,5.4,0,0,1,1.44,3.76c0,5.38-3.27,6.56-6.39,6.91a3.33,3.33,0,0,1,.95,2.59c0,1.87,0,3.38,0,3.84s.25.81,1,.67A14,14,0,0,0,16,2Z"></path>
    
  </svg></a></div></div>
</div>
	
	<div class="markdown overflow-scroll w-full lg:w-[700px] svelte-ee3m9d" style="height: 100vh;"><div class="markdown">
			<span class="jupyter">
			<div class="md" style="">
			<h1>
			Custom training loops</h1></div>
			<div class="md" style="">
			<p>
			How can we compose changes to the training loop together?</p>
			<p>
			As an example, we want to be able to do data-parallel training or GAN training, but also data-parallel GAN training.</p>
			<p>
			I want to give some thoughts on this and propose possible solutions to make this possible in 
			<em>
			FastAI.jl</em>
			.</p>
			<p>
			Currently, implementing custom training behavior is possible by subtyping 
			<span class="code"><code class="codeinline ">
			FitPhase</code></span>
			 and implementing 
			<span class="code"><code class="codeinline ">
			fitbatchphase!(learner, phase::MyPhase)</code></span>
			. However, this is not composable, i.e. it doesn&#39;t allow you to combine a 
			<span class="code"><code class="codeinline ">
			DataParallelTrainingPhase</code></span>
			 and 
			<span class="code"><code class="codeinline ">
			GANTrainingPhase</code></span>
			.</p>
			<p>
			Below are some examples that show how the contents of 
			<span class="code"><code class="codeinline ">
			fitbatchphase!</code></span>
			 can be changed to illustrate this. For simplicity, they don&#39;t include callbacks and state handling.</p></div>
			<div class="md" style="">
			<h4>
			Regular training (1)</h4></div>
			<div class="codecell" style="">
			<div class="codeinput" style="">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia">
			<span class="COMMENT">
			# inputs: model, xs, ys, lossfn, optim, params</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			grads</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			<span class="CALL">
			<span class="IDENTIFIER">
			gradient</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			params</span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="NEWLINE_WS">
			
    </span></span>
			<span class="BLOCK">
			<span class="RETURN">
			<span class="RETURN">
			return</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			lossfn</span>
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			model</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			xs</span>
			<span class="RPAREN">
			)</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys</span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
</span></span>
			<span class="END">
			end</span></span></span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			update!</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			optim</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			params</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			sum</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			grads</span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span></span></code></pre></div></div>
			<div class="md" style="">
			<h4>
			Data-parallel training on CPU (2)</h4></div>
			<div class="codecell" style="">
			<div class="codeinput" style="">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia">
			<span class="COMMENT">
			# inputs: model, xs, ys, lossfn, optim, params</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			grads</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="CURLY">
			<span class="IDENTIFIER">
			Array</span>
			<span class="LBRACE">
			{</span>
			<span class="IDENTIFIER">
			Grads</span>
			<span class="RBRACE">
			}</span></span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			undef</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="DOT">
			<span class="IDENTIFIER">
			Threads</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			nthreads</span></span></span>
			<span class="LPAREN">
			(</span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="COMMENT">
			# run equally-sized slices of the batch in parallel (naive pseudocode)</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="MACROCALL">
			<span class="DOT">
			<span class="IDENTIFIER">
			Threads</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="AT_SIGN">
			@</span>
			<span class="MACRO_NAME">
			threads</span></span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="FOR">
			<span class="FOR">
			for</span>
			<span class="EQ">
			<span class="WHITESPACE">
			 </span>
			<span class="TUPLE">
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			i</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="TUPLE">
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			xs_</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys_</span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="IN">
			in</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			enumerate</span>
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			scatter</span>
			<span class="LPAREN">
			(</span>
			<span class="TUPLE">
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			xs</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys</span>
			<span class="RPAREN">
			)</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="DOT">
			<span class="IDENTIFIER">
			Threads</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			nthreads</span></span></span>
			<span class="LPAREN">
			(</span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
    </span>
			<span class="EQ">
			<span class="REF">
			<span class="IDENTIFIER">
			grads</span>
			<span class="LSQUARE">
			[</span>
			<span class="IDENTIFIER">
			i</span>
			<span class="RSQUARE">
			]</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			<span class="CALL">
			<span class="IDENTIFIER">
			gradient</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			params</span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="NEWLINE_WS">
			
        </span></span>
			<span class="BLOCK">
			<span class="RETURN">
			<span class="RETURN">
			return</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			lossfn</span>
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			model</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			xs_</span>
			<span class="RPAREN">
			)</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys_</span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
    </span></span>
			<span class="END">
			end</span></span></span></span>
			<span class="NEWLINE_WS">
			
</span></span>
			<span class="END">
			end</span></span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			gs</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			sum</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			grads</span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="COMMENT">
			# do parameter update with summed gradients</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			update!</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			optim</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			params</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			gs</span>
			<span class="RPAREN">
			)</span></span></span></code></pre></div></div>
			<div class="md" style="">
			<h4>
			GAN training (3)</h4></div>
			<div class="codecell" style="">
			<div class="codeinput" style="">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia">
			<span class="COMMENT">
			# inputs: mgen, mcrit, paramsgen, paramscrit, xs_true, lossfngen, lossfncrit, optim, batchsize</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="COMMENT">
			# critic step</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			xs_fake</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			mgen</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			batchsize</span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			xs</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			cat</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			xs_true</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			xs_fake</span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			ys</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DOT">
			<span class="IDENTIFIER">
			onehot</span>
			<span class="DOT">
			.</span>
			<span class="TUPLE">
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			vcat</span>
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			trues</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			batchsize</span>
			<span class="RPAREN">
			)</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			falses</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			batchsize</span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span></span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			grads</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			<span class="CALL">
			<span class="IDENTIFIER">
			gradient</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			paramscrit</span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="NEWLINE_WS">
			
    </span></span>
			<span class="BLOCK">
			<span class="RETURN">
			<span class="RETURN">
			return</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			lossfncrit</span>
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			mcrit</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			xs</span>
			<span class="RPAREN">
			)</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys</span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
</span></span>
			<span class="END">
			end</span></span></span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			update!</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			optim</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			paramscrit</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			grads</span>
			<span class="RPAREN">
			)</span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="COMMENT">
			# generator step</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			grads</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			<span class="CALL">
			<span class="IDENTIFIER">
			gradient</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			paramsgen</span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="NEWLINE_WS">
			
    </span></span>
			<span class="BLOCK">
			<span class="EQ">
			<span class="IDENTIFIER">
			xs_fake</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			mgen</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			batchsize</span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
    </span>
			<span class="EQ">
			<span class="IDENTIFIER">
			ys_fake</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DOT">
			<span class="IDENTIFIER">
			onehot</span>
			<span class="DOT">
			.</span>
			<span class="TUPLE">
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			falses</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			batchsize</span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span></span></span>
			<span class="NEWLINE_WS">
			
    </span>
			<span class="RETURN">
			<span class="RETURN">
			return</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="MINUS">
			-</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			lossfncrit</span>
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			crit</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			xs_fake</span>
			<span class="RPAREN">
			)</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys_fake</span>
			<span class="RPAREN">
			)</span></span></span></span>
			<span class="NEWLINE_WS">
			
</span></span>
			<span class="END">
			end</span></span></span></span></span></code></pre></div></div>
			<div class="md" style="">
			<h3>
			Solutions</h3>
			<p>
			I have found two approaches to deal with this. 
			<strong>
			Both focus on removing execution logic from 
			<span class="code"><code class="codeinline ">
			fitbatchphase!</code></span>
			, making them composable with custom 
			<span class="code"><code class="codeinline ">
			Phase</code></span>
			s</strong>
			 like 
			<span class="code"><code class="codeinline ">
			GANTrainingPhase</code></span>
			 that change</p>
			<p>
			the 
			<em>
			semantics</em>
			 of the training loop.</p>
			<p>
			On one hand, there are extensions to the training loop that change the 
			<em>
			execution</em>
			 (e.g. parallel and distributed CPU and GPU training), on the other hand you have those that change the 
			<em>
			semantics</em>
			 (e.g. GAN training).</p>
			<p>
			The proposed solutions make the assumption that different 
			<em>
			semantics</em>
			 don&#39;t need to be composed, but should be composable with different execution contexts.</p></div>
			<div class="md" style="">
			<h4>
			(S1) Abstract gradient step (and possibly others) out</h4></div>
			<div class="md" style="">
			<p>
			Modifications to the execution of the training loop could be implemented by wrapping in an execution context.</p>
			<p>
			In the below example 
			<span class="code"><code class="codeinline ">
			gradientphase</code></span>
			 could dispatch to the regular gradient calculation in (1) or the data-parallel approach (2) depending on 
			<span class="code"><code class="codeinline ">
			executionctx</code></span>
			.</p>
			<p>
			This would mean that only 
			<em>
			semantic</em>
			 changes to the training loop would use overloading of 
			<span class="code"><code class="codeinline ">
			fitbatchphase!</code></span>
			 with a custom 
			<span class="code"><code class="codeinline ">
			FitPhase</code></span>
			. Changes to the 
			<em>
			execution</em>
			 work by dispatching on execution contexts, e.g. 
			<span class="code"><code class="codeinline ">
			gradientphase(::Linear, ...)</code></span>
			 or 
			<span class="code"><code class="codeinline ">
			gradientphase(::DataParallel, ...)</code></span>
			.</p></div>
			<div class="codecell" style="">
			<div class="codeinput" style="">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia">
			<span class="COMMENT">
			# gradientphase passes (possibly modified) state to a closure</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="COMMENT">
			# in the case executionctx::DataParallel, xs_, ys_ will be slices</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="COMMENT">
			# of the batch.</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			grads</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			<span class="CALL">
			<span class="IDENTIFIER">
			gradient</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			executionctx</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			params</span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			model_</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			params_</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			xs_</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys_</span>
			<span class="COMMA">
			,</span>
			<span class="NEWLINE_WS">
			 
    </span>
			<span class="RETURN">
			<span class="RETURN">
			return</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			lossfn</span>
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			model</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			xs_</span>
			<span class="RPAREN">
			)</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys_</span>
			<span class="RPAREN">
			)</span></span></span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
</span></span>
			<span class="END">
			end</span></span></span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			update!</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			optim</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			params</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			grads</span>
			<span class="RPAREN">
			)</span></span></span></code></pre></div></div>
			<div class="md" style="">
			<p>
			<strong>
			Advantages</strong></p>
			<ul>
			<li>
			<p>
			implementation definitely doable</p></li></ul>
			<p>
			<strong>
			Disadvantages</strong></p>
			<ul>
			<li>
			<p>
			implementation dependent on requirements, i.e. unsure which pieces of the training step need to be overloadable and which state needs to be passed to closures.</p></li></ul></div>
			<div class="md" style="">
			<h4>
			(S2) Wrapper for 
			<span class="code"><code class="codeinline ">
			model</code></span></h4></div>
			<div class="md" style="">
			<p>
			The idea is to wrap the 
			<span class="code"><code class="codeinline ">
			model</code></span>
			 in an execution context, e.g. 
			<span class="code"><code class="codeinline ">
			DataParallel(model)</code></span>
			. The wrapper is then responsible for exhibiting the correct behavior on the forward and backward pass. This is 
			<span class="linkexternal"><a rel="external" href="https://pytorch.org/docs/stable/generated/torch.nn.DataParallel.html?highlight=parallel#torch.nn.DataParallel" class="svelte-1jfpqr">
			what PyTorch does
		
<svg data-carbon-icon="Link16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" width="16" height="16" preserveAspectRatio="xMidYMid meet" style="display:inline; transform: translate(-1px,-2px)" aria-hidden focusable="false"><path d="M29.25,6.76a6,6,0,0,0-8.5,0l1.42,1.42a4,4,0,1,1,5.67,5.67l-8,8a4,4,0,1,1-5.67-5.66l1.41-1.42-1.41-1.42-1.42,1.42a6,6,0,0,0,0,8.5A6,6,0,0,0,17,25a6,6,0,0,0,4.27-1.76l8-8A6,6,0,0,0,29.25,6.76Z"></path><path d="M4.19,24.82a4,4,0,0,1,0-5.67l8-8a4,4,0,0,1,5.67,0A3.94,3.94,0,0,1,19,14a4,4,0,0,1-1.17,2.85L15.71,19l1.42,1.42,2.12-2.12a6,6,0,0,0-8.51-8.51l-8,8a6,6,0,0,0,0,8.51A6,6,0,0,0,7,28a6.07,6.07,0,0,0,4.28-1.76L9.86,24.82A4,4,0,0,1,4.19,24.82Z"></path>
    
  </svg></a>
</span>
			.</p>
			<p>
			No changes to the training loop would need to be made. The implementation for the forward pass should be straightforward and similar to the above sketch (2), however I&#39;m not sure how to make sure that the backward pass is also computed in parallel (can custom gradient definitions include multi-threading code?, what about the loss function that is not wrapped?).</p></div>
			<div class="codecell" style="">
			<div class="codeinput" style="">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia">
			<span class="COMMENT">
			# before training</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			model</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			DataParallel</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			model</span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="COMMENT">
			# training step doesn&#39;t change at all</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			grads</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			<span class="CALL">
			<span class="IDENTIFIER">
			gradient</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			params</span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="NEWLINE_WS">
			
    </span></span>
			<span class="BLOCK">
			<span class="RETURN">
			<span class="RETURN">
			return</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			lossfn</span>
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			model</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			xs</span>
			<span class="RPAREN">
			)</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys</span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
</span></span>
			<span class="END">
			end</span></span></span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="CALL">
			<span class="IDENTIFIER">
			update!</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			optim</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			params</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			sum</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			grads</span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span></span></code></pre></div></div>
			<div class="md" style="">
			<p>
			<strong>
			Advantages</strong></p>
			<ul>
			<li>
			<p>
			no changes needed to state and event handling</p></li></ul>
			<p>
			<strong>
			Disadvantages</strong></p>
			<ul>
			<li>
			<p>
			not sure if such a simple API is possible to implement for all scenarios</p></li>
			<li>
			<p>
			bit unelegant; model is not a pure function anymore</p></li></ul></div></span></div>

<div class="more"></div></div>
</div>


		<script type="module" data-hydrate="w2q1gs">
		import { start } from "/FluxTraining.jl/internal/start-8747b069.js";
		start({
			target: document.querySelector('[data-hydrate="w2q1gs"]').parentNode,
			paths: {"base":"/FluxTraining.jl","assets":"/FluxTraining.jl"},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/FluxTraining.jl/internal/pages/__layout.svelte-80f23352.js"),
						import("/FluxTraining.jl/internal/pages/_version_/_...documentId_.svelte-78a89889.js")
				],
				params: {version:"dev",documentId:"documents\u002Fdocs\u002Fcustom_training.ipynb"},
				routeId: "[version]/[...documentId]"
			}
		});
	</script><script type="application/json" sveltekit:data-type="data" sveltekit:data-url="/FluxTraining.jl/api/dev/config.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"linktree\":{\"Overview\":\"documents/README.md\",\"Getting started\":\"documents/docs/getting_started.md\",\"Features\":\"documents/docs/features.md\",\"Tutorials\":{\"Train an image classifier\":\"documents/docs/tutorials/mnist.ipynb\",\"Write a custom callback\":\"documents/docs/callbacks/custom.md\"},\"How to\":{\"Use callbacks\":\"documents/docs/callbacks/usage.md\",\"Tips & Tricks\":\"documents/docs/callbacks/tipstricks.md\"},\"Reference\":{\"Module\":\"references/FluxTraining\",\"List of callbacks\":\"documents/docs/callbacks/reference.md\",\"Training loop API\":\"documents/docs/reference/training.md\"},\"Backround\":{\"Hyperparameter scheduling\":\"documents/docs/tutorials/hyperparameters.md\",\"Custom training loops\":\"documents/docs/tutorials/training.md\"}},\"columnWidth\":650,\"title\":\"FluxTraining.jl\",\"url\":\"https://github.com/FluxML/FluxTraining.jl\",\"defaultDocument\":\"documents/README.md\"}"}</script>
	<script type="application/json" sveltekit:data-type="data" sveltekit:data-url="/FluxTraining.jl/api/dev/attributes.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"documents/CHANGELOG.md\":{\"tag\":\"document\",\"title\":\"News\"},\"references/FluxTraining.HyperParameter\":{\"tag\":\"documentation\",\"title\":\"HyperParameter\"},\"sourcefiles/FluxTraining/src/callbacks/scheduler.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/scheduler.jl\"},\"references/FluxTraining.savemodel\":{\"tag\":\"documentation\",\"title\":\"savemodel\"},\"references/FluxTraining.CheckModelLossStep\":{\"tag\":\"documentation\",\"title\":\"CheckModelLossStep\"},\"references/FluxTraining.CancelStepException\":{\"tag\":\"documentation\",\"title\":\"CancelStepException\"},\"references/FluxTraining.ConflictResolution\":{\"tag\":\"documentation\",\"title\":\"ConflictResolution\"},\"references/FluxTraining.replacecallback!\":{\"tag\":\"documentation\",\"title\":\"replacecallback!\"},\"documents/docs/tutorials/hyperparameters.md\":{\"tag\":\"document\",\"title\":\"Hyperparameter scheduling\"},\"sourcefiles/FluxTraining/src/callbacks/metrics.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/metrics.jl\"},\"references/FluxTraining.print_epoch_table\":{\"tag\":\"documentation\",\"title\":\"print_epoch_table\"},\"references/FluxTraining.log_to\":{\"tag\":\"documentation\",\"title\":\"log_to\"},\"references/FluxTraining.AbstractCallback\":{\"tag\":\"documentation\",\"title\":\"AbstractCallback\"},\"references/FluxTraining.getindexperm\":{\"tag\":\"documentation\",\"title\":\"getindexperm\"},\"sourcefiles/FluxTraining/src/callbacks/custom.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/custom.jl\"},\"references/FluxTraining.Phases.ValidationPhase\":{\"tag\":\"documentation\",\"title\":\"ValidationPhase\"},\"references/FluxTraining.iterpairs\":{\"tag\":\"documentation\",\"title\":\"iterpairs\"},\"references/FluxTraining.Callback\":{\"tag\":\"documentation\",\"title\":\"Callback\"},\"references/FluxTraining.StopOnNaNLoss\":{\"tag\":\"documentation\",\"title\":\"StopOnNaNLoss\"},\"references/FluxTraining.Protected\":{\"tag\":\"documentation\",\"title\":\"Protected\"},\"references/FluxTraining.Events.StepBegin\":{\"tag\":\"documentation\",\"title\":\"StepBegin\"},\"documents/LICENSE.md\":{\"tag\":\"document\",\"title\":\"LICENSE\"},\"references/FluxTraining.AbstractMetric\":{\"tag\":\"documentation\",\"title\":\"AbstractMetric\"},\"documents/docs/tutorials/mnist.ipynb\":{\"tag\":\"document\",\"title\":\"Training an image classifier\"},\"references/FluxTraining.edgesrunafter\":{\"tag\":\"documentation\",\"title\":\"edgesrunafter\"},\"references/FluxTraining.LinearRunner\":{\"tag\":\"documentation\",\"title\":\"LinearRunner\"},\"references/FluxTraining.protect\":{\"tag\":\"documentation\",\"title\":\"protect\"},\"references/FluxTraining.formataccess\":{\"tag\":\"documentation\",\"title\":\"formataccess\"},\"references/FluxTraining.resolveconflict\":{\"tag\":\"documentation\",\"title\":\"resolveconflict\"},\"documents/docs/callbacks/reference.md\":{\"tag\":\"document\",\"title\":\"Callback reference\"},\"references/FluxTraining.Loggables\":{\"tag\":\"documentation\",\"title\":\"Loggables\"},\"references/FluxTraining.setlearningrate!\":{\"tag\":\"documentation\",\"title\":\"setlearningrate!\"},\"references/FluxTraining.stepvalue\":{\"tag\":\"documentation\",\"title\":\"stepvalue\"},\"sourcefiles/FluxTraining/src/training.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/training.jl\"},\"sourcefiles/FluxTraining/src/callbacks/hyperparameters.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/hyperparameters.jl\"},\"references/FluxTraining.ProtectedException\":{\"tag\":\"documentation\",\"title\":\"ProtectedException\"},\"references/FluxTraining.FrequencyThrottle\":{\"tag\":\"documentation\",\"title\":\"FrequencyThrottle\"},\"references/FluxTraining.RunFirst\":{\"tag\":\"documentation\",\"title\":\"RunFirst\"},\"references/FluxTraining.Events.StepEnd\":{\"tag\":\"documentation\",\"title\":\"StepEnd\"},\"references/FluxTraining.SanityCheck\":{\"tag\":\"documentation\",\"title\":\"SanityCheck\"},\"references/FluxTraining.ToDevice\":{\"tag\":\"documentation\",\"title\":\"ToDevice\"},\"references/FluxTraining.Loggables.Audio\":{\"tag\":\"documentation\",\"title\":\"Audio\"},\"documents/docs/imagenette_demo.ipynb\":{\"tag\":\"document\",\"title\":\"imagenette_demo\"},\"sourcefiles/FluxTraining/src/callbacks/protect.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/protect.jl\"},\"references/FluxTraining.Loggables.Image\":{\"tag\":\"documentation\",\"title\":\"Image\"},\"references/FluxTraining.CustomCallback\":{\"tag\":\"documentation\",\"title\":\"CustomCallback\"},\"sourcefiles/FluxTraining/src/callbacks/logging/logger.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/logging/logger.jl\"},\"references/FluxTraining.ToGPU\":{\"tag\":\"documentation\",\"title\":\"ToGPU\"},\"sourcefiles/FluxTraining/src/functional/metrics.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/functional/metrics.jl\"},\"references/FluxTraining.on\":{\"tag\":\"documentation\",\"title\":\"on\"},\"references/FluxTraining.accuracy\":{\"tag\":\"documentation\",\"title\":\"accuracy\"},\"sourcefiles/FluxTraining/src/callbackutils.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbackutils.jl\"},\"references/FluxTraining.Check\":{\"tag\":\"documentation\",\"title\":\"Check\"},\"references/FluxTraining.throttle\":{\"tag\":\"documentation\",\"title\":\"throttle\"},\"references/FluxTraining.Callbacks\":{\"tag\":\"documentation\",\"title\":\"Callbacks\"},\"references/FluxTraining.LearningRate\":{\"tag\":\"documentation\",\"title\":\"LearningRate\"},\"references/FluxTraining.Metric\":{\"tag\":\"documentation\",\"title\":\"Metric\"},\"references/FluxTraining.FitException\":{\"tag\":\"documentation\",\"title\":\"FitException\"},\"sourcefiles/FluxTraining/src/callbacks/graph.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/graph.jl\"},\"documents/docs/background/lossfunction.md\":{\"tag\":\"document\",\"title\":\"Loss functions\"},\"sourcefiles/FluxTraining/src/FluxTraining.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/FluxTraining.jl\"},\"sourcefiles/FluxTraining/src/callbacks/execution.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/execution.jl\"},\"references/FluxTraining.setupoptimstate\":{\"tag\":\"documentation\",\"title\":\"setupoptimstate\"},\"references/FluxTraining.testbatch\":{\"tag\":\"documentation\",\"title\":\"testbatch\"},\"references/FluxTraining.Phases.AbstractTrainingPhase\":{\"tag\":\"documentation\",\"title\":\"AbstractTrainingPhase\"},\"references/FluxTraining.stateaccess\":{\"tag\":\"documentation\",\"title\":\"stateaccess\"},\"documents/README.md\":{\"tag\":\"document\",\"title\":\"FluxTraining.jl\"},\"references/FluxTraining.GarbageCollect\":{\"tag\":\"documentation\",\"title\":\"GarbageCollect\"},\"sourcefiles/FluxTraining/src/callbacks/logging/Loggables.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/logging/Loggables.jl\"},\"references/FluxTraining.runtests\":{\"tag\":\"documentation\",\"title\":\"runtests\"},\"references/FluxTraining.Loggables.Graph\":{\"tag\":\"documentation\",\"title\":\"Graph\"},\"references/FluxTraining.LogVisualization\":{\"tag\":\"documentation\",\"title\":\"LogVisualization\"},\"references/FluxTraining.Events\":{\"tag\":\"documentation\",\"title\":\"Events\"},\"references/FluxTraining.NoConflict\":{\"tag\":\"documentation\",\"title\":\"NoConflict\"},\"references/FluxTraining.defaultcallbacks\":{\"tag\":\"documentation\",\"title\":\"defaultcallbacks\"},\"references/FluxTraining.Events.Event\":{\"tag\":\"documentation\",\"title\":\"Event\"},\"references/FluxTraining.Learner\":{\"tag\":\"documentation\",\"title\":\"Learner\"},\"references/FluxTraining.setindexperm!\":{\"tag\":\"documentation\",\"title\":\"setindexperm!\"},\"references/FluxTraining.CancelFittingException\":{\"tag\":\"documentation\",\"title\":\"CancelFittingException\"},\"references/FluxTraining.metricname\":{\"tag\":\"documentation\",\"title\":\"metricname\"},\"references/FluxTraining.ES\":{\"tag\":\"documentation\",\"title\":\"ES\"},\"references/FluxTraining.runafter\":{\"tag\":\"documentation\",\"title\":\"runafter\"},\"references/FluxTraining.MetricsPrinter\":{\"tag\":\"documentation\",\"title\":\"MetricsPrinter\"},\"references/FluxTraining.hasconflict\":{\"tag\":\"documentation\",\"title\":\"hasconflict\"},\"references/FluxTraining.runchecks\":{\"tag\":\"documentation\",\"title\":\"runchecks\"},\"references/FluxTraining.TimeThrottle\":{\"tag\":\"documentation\",\"title\":\"TimeThrottle\"},\"sourcefiles/FluxTraining/src/callbacks/sanitycheck.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/sanitycheck.jl\"},\"references/FluxTraining.ConditionalCallback\":{\"tag\":\"documentation\",\"title\":\"ConditionalCallback\"},\"references/FluxTraining.LogHyperParams\":{\"tag\":\"documentation\",\"title\":\"LogHyperParams\"},\"references/FluxTraining.History\":{\"tag\":\"documentation\",\"title\":\"History\"},\"references/FluxTraining.Scheduler\":{\"tag\":\"documentation\",\"title\":\"Scheduler\"},\"references/FluxTraining.Phases.TrainingPhase\":{\"tag\":\"documentation\",\"title\":\"TrainingPhase\"},\"documents/docs/background/model.md\":{\"tag\":\"document\",\"title\":\"Models\"},\"references/FluxTraining.Checkpointer\":{\"tag\":\"documentation\",\"title\":\"Checkpointer\"},\"references/FluxTraining.Events.BackwardEnd\":{\"tag\":\"documentation\",\"title\":\"BackwardEnd\"},\"references/FluxTraining.Loggables.Histogram\":{\"tag\":\"documentation\",\"title\":\"Histogram\"},\"references/FluxTraining.CheckIteratesTuples\":{\"tag\":\"documentation\",\"title\":\"CheckIteratesTuples\"},\"references/FluxTraining.phasedataiter\":{\"tag\":\"documentation\",\"title\":\"phasedataiter\"},\"references/FluxTraining.EarlyStopping\":{\"tag\":\"documentation\",\"title\":\"EarlyStopping\"},\"references/FluxTraining.sethyperparameter!\":{\"tag\":\"documentation\",\"title\":\"sethyperparameter!\"},\"references/FluxTraining.Write\":{\"tag\":\"documentation\",\"title\":\"Write\"},\"references/FluxTraining.Events.EpochEnd\":{\"tag\":\"documentation\",\"title\":\"EpochEnd\"},\"references/FluxTraining.callbackgraph\":{\"tag\":\"documentation\",\"title\":\"callbackgraph\"},\"references/FluxTraining.Phases\":{\"tag\":\"documentation\",\"title\":\"Phases\"},\"references/FluxTraining.TensorBoardBackend\":{\"tag\":\"documentation\",\"title\":\"TensorBoardBackend\"},\"documents/docs/background/optimizer.md\":{\"tag\":\"document\",\"title\":\"Optimizers\"},\"references/FluxTraining.testlearner\":{\"tag\":\"documentation\",\"title\":\"testlearner\"},\"references/FluxTraining.epochvalue\":{\"tag\":\"documentation\",\"title\":\"epochvalue\"},\"documents/docs/getting_started.md\":{\"tag\":\"document\",\"title\":\"Getting started\"},\"references/FluxTraining.garbagecollect\":{\"tag\":\"documentation\",\"title\":\"garbagecollect\"},\"documents/docs/custom_training.ipynb\":{\"tag\":\"document\",\"title\":\"Custom training loops\"},\"references/FluxTraining.epoch!\":{\"tag\":\"documentation\",\"title\":\"epoch!\"},\"references/FluxTraining.SmoothLoss\":{\"tag\":\"documentation\",\"title\":\"SmoothLoss\"},\"references/FluxTraining.Phases.Phase\":{\"tag\":\"documentation\",\"title\":\"Phase\"},\"references/FluxTraining.setcallbacks!\":{\"tag\":\"documentation\",\"title\":\"setcallbacks!\"},\"references/FluxTraining.Unresolvable\":{\"tag\":\"documentation\",\"title\":\"Unresolvable\"},\"references/FluxTraining\":{\"tag\":\"documentation\",\"title\":\"FluxTraining\"},\"references/FluxTraining.testbatches\":{\"tag\":\"documentation\",\"title\":\"testbatches\"},\"documents/docs/overview.md\":{\"tag\":\"document\",\"title\":\"Getting started\"},\"references/FluxTraining.accesses\":{\"tag\":\"documentation\",\"title\":\"accesses\"},\"documents/docs/callbacks/tipstricks.md\":{\"tag\":\"document\",\"title\":\"Tips & tricks\"},\"references/FluxTraining.Phases.AbstractValidationPhase\":{\"tag\":\"documentation\",\"title\":\"AbstractValidationPhase\"},\"sourcefiles/FluxTraining/src/callbacks/recorder.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/recorder.jl\"},\"references/FluxTraining.NotDefined\":{\"tag\":\"documentation\",\"title\":\"NotDefined\"},\"references/FluxTraining.findconflicts\":{\"tag\":\"documentation\",\"title\":\"findconflicts\"},\"references/FluxTraining.Loggables.Text\":{\"tag\":\"documentation\",\"title\":\"Text\"},\"references/FluxTraining.PropDict\":{\"tag\":\"documentation\",\"title\":\"PropDict\"},\"documents/docs/callbacks/usage.md\":{\"tag\":\"document\",\"title\":\"How to use callbacks\"},\"references/FluxTraining.Events.LossBegin\":{\"tag\":\"documentation\",\"title\":\"LossBegin\"},\"references/FluxTraining.Recorder\":{\"tag\":\"documentation\",\"title\":\"Recorder\"},\"references/FluxTraining.LogMetrics\":{\"tag\":\"documentation\",\"title\":\"LogMetrics\"},\"references/FluxTraining.fit!\":{\"tag\":\"documentation\",\"title\":\"fit!\"},\"references/FluxTraining.SanityCheckException\":{\"tag\":\"documentation\",\"title\":\"SanityCheckException\"},\"references/FluxTraining.UnsafeCallback\":{\"tag\":\"documentation\",\"title\":\"UnsafeCallback\"},\"sourcefiles/FluxTraining/src/callbacks/callbacks.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/callbacks.jl\"},\"references/FluxTraining.CancelEpochException\":{\"tag\":\"documentation\",\"title\":\"CancelEpochException\"},\"references/FluxTraining.Permission\":{\"tag\":\"documentation\",\"title\":\"Permission\"},\"sourcefiles/FluxTraining/src/testutils.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/testutils.jl\"},\"references/FluxTraining.runstep\":{\"tag\":\"documentation\",\"title\":\"runstep\"},\"references/FluxTraining.removecallback!\":{\"tag\":\"documentation\",\"title\":\"removecallback!\"},\"references/FluxTraining.CallbackRunner\":{\"tag\":\"documentation\",\"title\":\"CallbackRunner\"},\"references/FluxTraining.addcallback!\":{\"tag\":\"documentation\",\"title\":\"addcallback!\"},\"references/FluxTraining.CheckDataIteratorTrain\":{\"tag\":\"documentation\",\"title\":\"CheckDataIteratorTrain\"},\"references/FluxTraining.reset!\":{\"tag\":\"documentation\",\"title\":\"reset!\"},\"sourcefiles/FluxTraining/src/callbacks/callback.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/callback.jl\"},\"references/FluxTraining.Events.BackwardBegin\":{\"tag\":\"documentation\",\"title\":\"BackwardBegin\"},\"sourcefiles/FluxTraining/src/learner.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/learner.jl\"},\"references/FluxTraining.Loss\":{\"tag\":\"documentation\",\"title\":\"Loss\"},\"sourcefiles/FluxTraining/src/callbacks/phases.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/phases.jl\"},\"references/FluxTraining.runepoch\":{\"tag\":\"documentation\",\"title\":\"runepoch\"},\"sourcefiles/FluxTraining/src/callbacks/conditional.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/conditional.jl\"},\"documents/docs/features.md\":{\"tag\":\"document\",\"title\":\"Features\"},\"references/FluxTraining.LogHistograms\":{\"tag\":\"documentation\",\"title\":\"LogHistograms\"},\"references/FluxTraining.shouldrun\":{\"tag\":\"documentation\",\"title\":\"shouldrun\"},\"sourcefiles/FluxTraining/src/callbacks/events.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/events.jl\"},\"references/FluxTraining.init!\":{\"tag\":\"documentation\",\"title\":\"init!\"},\"references/FluxTraining.setfieldperm!\":{\"tag\":\"documentation\",\"title\":\"setfieldperm!\"},\"references/FluxTraining.getfieldperm\":{\"tag\":\"documentation\",\"title\":\"getfieldperm\"},\"references/FluxTraining.CHECKS\":{\"tag\":\"documentation\",\"title\":\"CHECKS\"},\"documents/docs/reference/training.md\":{\"tag\":\"document\",\"title\":\"Training loop API reference\"},\"references/FluxTraining.Loggables.File\":{\"tag\":\"documentation\",\"title\":\"File\"},\"references/FluxTraining.Metrics\":{\"tag\":\"documentation\",\"title\":\"Metrics\"},\"references/FluxTraining.log_parameters\":{\"tag\":\"documentation\",\"title\":\"log_parameters\"},\"references/FluxTraining.model!\":{\"tag\":\"documentation\",\"title\":\"model!\"},\"references/FluxTraining.Events.EpochBegin\":{\"tag\":\"documentation\",\"title\":\"EpochBegin\"},\"references/FluxTraining.CallbackCondition\":{\"tag\":\"documentation\",\"title\":\"CallbackCondition\"},\"sourcefiles/FluxTraining/src/callbacks/logging/checkpointer.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/logging/checkpointer.jl\"},\"references/FluxTraining.onecycle\":{\"tag\":\"documentation\",\"title\":\"onecycle\"},\"references/FluxTraining.loadmodel\":{\"tag\":\"documentation\",\"title\":\"loadmodel\"},\"sourcefiles/FluxTraining/src/callbacks/earlystopping.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/earlystopping.jl\"},\"references/FluxTraining.Loggables.Loggable\":{\"tag\":\"documentation\",\"title\":\"Loggable\"},\"references/FluxTraining.Read\":{\"tag\":\"documentation\",\"title\":\"Read\"},\"references/FluxTraining.step!\":{\"tag\":\"documentation\",\"title\":\"step!\"},\"references/FluxTraining.ProgressPrinter\":{\"tag\":\"documentation\",\"title\":\"ProgressPrinter\"},\"references/FluxTraining.getcallback\":{\"tag\":\"documentation\",\"title\":\"getcallback\"},\"references/FluxTraining.handle\":{\"tag\":\"documentation\",\"title\":\"handle\"},\"documents/docs/tutorials/training.md\":{\"tag\":\"document\",\"title\":\"Training loop\"},\"references/FluxTraining.SafeCallback\":{\"tag\":\"documentation\",\"title\":\"SafeCallback\"},\"documents/docs/callbacks/custom.md\":{\"tag\":\"document\",\"title\":\"Custom callbacks\"},\"sourcefiles/FluxTraining/src/callbacks/logging/tensorboard.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/logging/tensorboard.jl\"},\"references/FluxTraining.CheckDataIteratorValid\":{\"tag\":\"documentation\",\"title\":\"CheckDataIteratorValid\"},\"references/FluxTraining.errorwriteconflict\":{\"tag\":\"documentation\",\"title\":\"errorwriteconflict\"},\"references/FluxTraining.Loggables.Value\":{\"tag\":\"documentation\",\"title\":\"Value\"},\"references/FluxTraining.TestModel\":{\"tag\":\"documentation\",\"title\":\"TestModel\"},\"references/FluxTraining.LoggerBackend\":{\"tag\":\"documentation\",\"title\":\"LoggerBackend\"},\"documents/docs/background/dataiterator.md\":{\"tag\":\"document\",\"title\":\"Data iterators\"}}"}</script>
	<script type="application/json" sveltekit:data-type="data" sveltekit:data-url="/FluxTraining.jl/api/dev/searchindex.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"version\":\"2.3.9\",\"fields\":[\"title\",\"body\"],\"fieldVectors\":[[\"title/references/FluxTraining.on\",[]],[\"body/references/FluxTraining.on\",[]],[\"title/documents/CHANGELOG.md\",[0,4.873]],[\"body/documents/CHANGELOG.md\",[]],[\"title/references/FluxTraining.HyperParameter\",[1,4.341]],[\"body/references/FluxTraining.HyperParameter\",[]],[\"title/references/FluxTraining.savemodel\",[2,4.873]],[\"body/references/FluxTraining.savemodel\",[]],[\"title/references/FluxTraining.removecallback!\",[3,4.873]],[\"body/references/FluxTraining.removecallback!\",[]],[\"title/references/FluxTraining.accuracy\",[4,4.873]],[\"body/references/FluxTraining.accuracy\",[]],[\"title/references/FluxTraining.CheckModelLossStep\",[5,4.873]],[\"body/references/FluxTraining.CheckModelLossStep\",[]],[\"title/references/FluxTraining.CancelStepException\",[6,4.873]],[\"body/references/FluxTraining.CancelStepException\",[]],[\"title/references/FluxTraining.CallbackRunner\",[7,4.873]],[\"body/references/FluxTraining.CallbackRunner\",[]],[\"title/references/FluxTraining.Check\",[8,4.341]],[\"body/references/FluxTraining.Check\",[]],[\"title/references/FluxTraining.ConflictResolution\",[9,4.873]],[\"body/references/FluxTraining.ConflictResolution\",[]],[\"title/references/FluxTraining.replacecallback!\",[10,4.873]],[\"body/references/FluxTraining.replacecallback!\",[]],[\"title/references/FluxTraining.throttle\",[11,4.873]],[\"body/references/FluxTraining.throttle\",[]],[\"title/references/FluxTraining.Callbacks\",[12,3.52]],[\"body/references/FluxTraining.Callbacks\",[]],[\"title/references/FluxTraining.addcallback!\",[13,4.873]],[\"body/references/FluxTraining.addcallback!\",[]],[\"title/references/FluxTraining.CheckDataIteratorTrain\",[14,4.873]],[\"body/references/FluxTraining.CheckDataIteratorTrain\",[]],[\"title/references/FluxTraining.LearningRate\",[15,4.873]],[\"body/references/FluxTraining.LearningRate\",[]],[\"title/documents/docs/tutorials/hyperparameters.md\",[1,3.134,16,3.134]],[\"body/documents/docs/tutorials/hyperparameters.md\",[]],[\"title/references/FluxTraining.CheckIteratesTuples\",[17,4.873]],[\"body/references/FluxTraining.CheckIteratesTuples\",[]],[\"title/references/FluxTraining.Metric\",[18,4.341]],[\"body/references/FluxTraining.Metric\",[]],[\"title/references/FluxTraining.reset!\",[19,4.873]],[\"body/references/FluxTraining.reset!\",[]],[\"title/references/FluxTraining.phasedataiter\",[20,4.873]],[\"body/references/FluxTraining.phasedataiter\",[]],[\"title/references/FluxTraining.Events.BackwardBegin\",[21,4.873]],[\"body/references/FluxTraining.Events.BackwardBegin\",[]],[\"title/references/FluxTraining.FitException\",[22,4.873]],[\"body/references/FluxTraining.FitException\",[]],[\"title/references/FluxTraining.EarlyStopping\",[23,4.873]],[\"body/references/FluxTraining.EarlyStopping\",[]],[\"title/references/FluxTraining.Loss\",[24,4.341]],[\"body/references/FluxTraining.Loss\",[]],[\"title/documents/docs/background/lossfunction.md\",[24,3.134,25,3.518]],[\"body/documents/docs/background/lossfunction.md\",[]],[\"title/references/FluxTraining.runepoch\",[26,4.873]],[\"body/references/FluxTraining.runepoch\",[]],[\"title/references/FluxTraining.sethyperparameter!\",[27,4.873]],[\"body/references/FluxTraining.sethyperparameter!\",[]],[\"title/references/FluxTraining.Write\",[28,4.873]],[\"body/references/FluxTraining.Write\",[]],[\"title/references/FluxTraining.Events.EpochEnd\",[29,4.873]],[\"body/references/FluxTraining.Events.EpochEnd\",[]],[\"title/references/FluxTraining.print_epoch_table\",[30,4.873]],[\"body/references/FluxTraining.print_epoch_table\",[]],[\"title/references/FluxTraining.setupoptimstate\",[31,4.873]],[\"body/references/FluxTraining.setupoptimstate\",[]],[\"title/references/FluxTraining.log_to\",[32,4.873]],[\"body/references/FluxTraining.log_to\",[]],[\"title/references/FluxTraining.callbackgraph\",[33,4.873]],[\"body/references/FluxTraining.callbackgraph\",[]],[\"title/references/FluxTraining.AbstractCallback\",[34,4.873]],[\"body/references/FluxTraining.AbstractCallback\",[]],[\"title/references/FluxTraining.Phases\",[35,4.341]],[\"body/references/FluxTraining.Phases\",[]],[\"title/documents/docs/features.md\",[36,4.873]],[\"body/documents/docs/features.md\",[]],[\"title/references/FluxTraining.TensorBoardBackend\",[37,4.873]],[\"body/references/FluxTraining.TensorBoardBackend\",[]],[\"title/references/FluxTraining.getindexperm\",[38,4.873]],[\"body/references/FluxTraining.getindexperm\",[]],[\"title/references/FluxTraining.testbatch\",[39,4.341]],[\"body/references/FluxTraining.testbatch\",[]],[\"title/references/FluxTraining.LogHistograms\",[40,4.873]],[\"body/references/FluxTraining.LogHistograms\",[]],[\"title/documents/docs/background/optimizer.md\",[41,4.873]],[\"body/documents/docs/background/optimizer.md\",[]],[\"title/references/FluxTraining.testlearner\",[42,4.873]],[\"body/references/FluxTraining.testlearner\",[]],[\"title/references/FluxTraining.Phases.ValidationPhase\",[43,4.873]],[\"body/references/FluxTraining.Phases.ValidationPhase\",[]],[\"title/references/FluxTraining.epochvalue\",[44,4.873]],[\"body/references/FluxTraining.epochvalue\",[]],[\"title/references/FluxTraining.iterpairs\",[45,4.873]],[\"body/references/FluxTraining.iterpairs\",[]],[\"title/documents/docs/getting_started.md\",[46,3.134,47,3.134]],[\"body/documents/docs/getting_started.md\",[]],[\"title/references/FluxTraining.Callback\",[12,3.52]],[\"body/references/FluxTraining.Callback\",[]],[\"title/references/FluxTraining.garbagecollect\",[48,4.341]],[\"body/references/FluxTraining.garbagecollect\",[]],[\"title/references/FluxTraining.shouldrun\",[49,4.873]],[\"body/references/FluxTraining.shouldrun\",[]],[\"title/references/FluxTraining.init!\",[50,4.873]],[\"body/references/FluxTraining.init!\",[]],[\"title/references/FluxTraining.StopOnNaNLoss\",[51,4.873]],[\"body/references/FluxTraining.StopOnNaNLoss\",[]],[\"title/references/FluxTraining.setfieldperm!\",[52,4.873]],[\"body/references/FluxTraining.setfieldperm!\",[]],[\"title/references/FluxTraining.Protected\",[53,4.341]],[\"body/references/FluxTraining.Protected\",[]],[\"title/documents/docs/custom_training.ipynb\",[54,2.452,55,2.107,56,2.254]],[\"body/documents/docs/custom_training.ipynb\",[]],[\"title/references/FluxTraining.Events.StepBegin\",[57,4.873]],[\"body/references/FluxTraining.Events.StepBegin\",[]],[\"title/documents/LICENSE.md\",[58,4.873]],[\"body/documents/LICENSE.md\",[]],[\"title/references/FluxTraining.AbstractMetric\",[59,4.873]],[\"body/references/FluxTraining.AbstractMetric\",[]],[\"title/references/FluxTraining.epoch!\",[60,4.873]],[\"body/references/FluxTraining.epoch!\",[]],[\"title/references/FluxTraining.Phases.AbstractTrainingPhase\",[61,4.873]],[\"body/references/FluxTraining.Phases.AbstractTrainingPhase\",[]],[\"title/references/FluxTraining.getfieldperm\",[62,4.873]],[\"body/references/FluxTraining.getfieldperm\",[]],[\"title/references/FluxTraining.SmoothLoss\",[63,4.873]],[\"body/references/FluxTraining.SmoothLoss\",[]],[\"title/references/FluxTraining.CHECKS\",[8,4.341]],[\"body/references/FluxTraining.CHECKS\",[]],[\"title/references/FluxTraining.stateaccess\",[64,4.873]],[\"body/references/FluxTraining.stateaccess\",[]],[\"title/documents/docs/tutorials/mnist.ipynb\",[55,2.107,65,2.452,66,2.753]],[\"body/documents/docs/tutorials/mnist.ipynb\",[]],[\"title/references/FluxTraining.Phases.Phase\",[35,4.341]],[\"body/references/FluxTraining.Phases.Phase\",[]],[\"title/references/FluxTraining.setcallbacks!\",[67,4.873]],[\"body/references/FluxTraining.setcallbacks!\",[]],[\"title/documents/docs/reference/training.md\",[55,1.73,56,1.852,68,2.261,69,2.014]],[\"body/documents/docs/reference/training.md\",[]],[\"title/documents/README.md\",[70,4.873]],[\"body/documents/README.md\",[]],[\"title/references/FluxTraining.GarbageCollect\",[48,4.341]],[\"body/references/FluxTraining.GarbageCollect\",[]],[\"title/references/FluxTraining.Loggables.File\",[71,4.873]],[\"body/references/FluxTraining.Loggables.File\",[]],[\"title/references/FluxTraining.edgesrunafter\",[72,4.873]],[\"body/references/FluxTraining.edgesrunafter\",[]],[\"title/references/FluxTraining.runtests\",[73,4.873]],[\"body/references/FluxTraining.runtests\",[]],[\"title/references/FluxTraining.Loggables.Graph\",[74,4.873]],[\"body/references/FluxTraining.Loggables.Graph\",[]],[\"title/references/FluxTraining.Metrics\",[18,4.341]],[\"body/references/FluxTraining.Metrics\",[]],[\"title/references/FluxTraining.LinearRunner\",[75,4.873]],[\"body/references/FluxTraining.LinearRunner\",[]],[\"title/references/FluxTraining.Unresolvable\",[76,4.873]],[\"body/references/FluxTraining.Unresolvable\",[]],[\"title/references/FluxTraining\",[77,4.873]],[\"body/references/FluxTraining\",[]],[\"title/references/FluxTraining.protect\",[53,4.341]],[\"body/references/FluxTraining.protect\",[]],[\"title/references/FluxTraining.testbatches\",[39,4.341]],[\"body/references/FluxTraining.testbatches\",[]],[\"title/references/FluxTraining.LogVisualization\",[78,4.873]],[\"body/references/FluxTraining.LogVisualization\",[]],[\"title/references/FluxTraining.formataccess\",[79,4.873]],[\"body/references/FluxTraining.formataccess\",[]],[\"title/references/FluxTraining.log_parameters\",[80,4.873]],[\"body/references/FluxTraining.log_parameters\",[]],[\"title/documents/docs/overview.md\",[46,3.134,47,3.134]],[\"body/documents/docs/overview.md\",[]],[\"title/references/FluxTraining.model!\",[81,4.341]],[\"body/references/FluxTraining.model!\",[]],[\"title/references/FluxTraining.Events.EpochBegin\",[82,4.873]],[\"body/references/FluxTraining.Events.EpochBegin\",[]],[\"title/references/FluxTraining.Events\",[83,4.341]],[\"body/references/FluxTraining.Events\",[]],[\"title/references/FluxTraining.NoConflict\",[84,4.873]],[\"body/references/FluxTraining.NoConflict\",[]],[\"title/references/FluxTraining.resolveconflict\",[85,4.873]],[\"body/references/FluxTraining.resolveconflict\",[]],[\"title/documents/docs/callbacks/reference.md\",[12,2.542,69,3.134]],[\"body/documents/docs/callbacks/reference.md\",[]],[\"title/references/FluxTraining.defaultcallbacks\",[86,4.873]],[\"body/references/FluxTraining.defaultcallbacks\",[]],[\"title/references/FluxTraining.Loggables\",[87,4.341]],[\"body/references/FluxTraining.Loggables\",[]],[\"title/references/FluxTraining.Events.Event\",[83,4.341]],[\"body/references/FluxTraining.Events.Event\",[]],[\"title/references/FluxTraining.accesses\",[88,4.873]],[\"body/references/FluxTraining.accesses\",[]],[\"title/references/FluxTraining.Learner\",[89,4.873]],[\"body/references/FluxTraining.Learner\",[]],[\"title/references/FluxTraining.setindexperm!\",[90,4.873]],[\"body/references/FluxTraining.setindexperm!\",[]],[\"title/references/FluxTraining.CallbackCondition\",[91,4.873]],[\"body/references/FluxTraining.CallbackCondition\",[]],[\"title/documents/docs/callbacks/tipstricks.md\",[92,2.753,93,2.753,94,2.753]],[\"body/documents/docs/callbacks/tipstricks.md\",[]],[\"title/references/FluxTraining.setlearningrate!\",[95,4.873]],[\"body/references/FluxTraining.setlearningrate!\",[]],[\"title/references/FluxTraining.stepvalue\",[96,4.873]],[\"body/references/FluxTraining.stepvalue\",[]],[\"title/references/FluxTraining.Phases.AbstractValidationPhase\",[97,4.873]],[\"body/references/FluxTraining.Phases.AbstractValidationPhase\",[]],[\"title/references/FluxTraining.onecycle\",[98,4.873]],[\"body/references/FluxTraining.onecycle\",[]],[\"title/references/FluxTraining.CancelFittingException\",[99,4.873]],[\"body/references/FluxTraining.CancelFittingException\",[]],[\"title/references/FluxTraining.loadmodel\",[100,4.873]],[\"body/references/FluxTraining.loadmodel\",[]],[\"title/references/FluxTraining.NotDefined\",[101,4.873]],[\"body/references/FluxTraining.NotDefined\",[]],[\"title/references/FluxTraining.Loggables.Loggable\",[87,4.341]],[\"body/references/FluxTraining.Loggables.Loggable\",[]],[\"title/references/FluxTraining.metricname\",[102,4.873]],[\"body/references/FluxTraining.metricname\",[]],[\"title/references/FluxTraining.findconflicts\",[103,4.873]],[\"body/references/FluxTraining.findconflicts\",[]],[\"title/references/FluxTraining.Loggables.Text\",[104,4.873]],[\"body/references/FluxTraining.Loggables.Text\",[]],[\"title/references/FluxTraining.Read\",[105,4.873]],[\"body/references/FluxTraining.Read\",[]],[\"title/references/FluxTraining.ES\",[106,4.873]],[\"body/references/FluxTraining.ES\",[]],[\"title/references/FluxTraining.runafter\",[107,4.873]],[\"body/references/FluxTraining.runafter\",[]],[\"title/references/FluxTraining.PropDict\",[108,4.873]],[\"body/references/FluxTraining.PropDict\",[]],[\"title/references/FluxTraining.MetricsPrinter\",[109,4.873]],[\"body/references/FluxTraining.MetricsPrinter\",[]],[\"title/references/FluxTraining.hasconflict\",[110,4.873]],[\"body/references/FluxTraining.hasconflict\",[]],[\"title/references/FluxTraining.ProtectedException\",[111,4.873]],[\"body/references/FluxTraining.ProtectedException\",[]],[\"title/references/FluxTraining.step!\",[112,4.873]],[\"body/references/FluxTraining.step!\",[]],[\"title/references/FluxTraining.ProgressPrinter\",[113,4.873]],[\"body/references/FluxTraining.ProgressPrinter\",[]],[\"title/references/FluxTraining.FrequencyThrottle\",[114,4.873]],[\"body/references/FluxTraining.FrequencyThrottle\",[]],[\"title/documents/docs/callbacks/usage.md\",[12,2.542,115,3.518]],[\"body/documents/docs/callbacks/usage.md\",[]],[\"title/references/FluxTraining.runchecks\",[116,4.873]],[\"body/references/FluxTraining.runchecks\",[]],[\"title/references/FluxTraining.RunFirst\",[117,4.873]],[\"body/references/FluxTraining.RunFirst\",[]],[\"title/references/FluxTraining.getcallback\",[118,4.873]],[\"body/references/FluxTraining.getcallback\",[]],[\"title/references/FluxTraining.Events.LossBegin\",[119,4.873]],[\"body/references/FluxTraining.Events.LossBegin\",[]],[\"title/references/FluxTraining.Events.StepEnd\",[120,4.873]],[\"body/references/FluxTraining.Events.StepEnd\",[]],[\"title/references/FluxTraining.handle\",[121,4.873]],[\"body/references/FluxTraining.handle\",[]],[\"title/documents/docs/tutorials/training.md\",[55,2.692,56,2.881]],[\"body/documents/docs/tutorials/training.md\",[]],[\"title/references/FluxTraining.SanityCheck\",[122,4.873]],[\"body/references/FluxTraining.SanityCheck\",[]],[\"title/references/FluxTraining.TimeThrottle\",[123,4.873]],[\"body/references/FluxTraining.TimeThrottle\",[]],[\"title/references/FluxTraining.Recorder\",[124,4.873]],[\"body/references/FluxTraining.Recorder\",[]],[\"title/references/FluxTraining.ToDevice\",[125,4.873]],[\"body/references/FluxTraining.ToDevice\",[]],[\"title/references/FluxTraining.ConditionalCallback\",[126,4.873]],[\"body/references/FluxTraining.ConditionalCallback\",[]],[\"title/references/FluxTraining.LogMetrics\",[127,4.873]],[\"body/references/FluxTraining.LogMetrics\",[]],[\"title/references/FluxTraining.SafeCallback\",[128,4.873]],[\"body/references/FluxTraining.SafeCallback\",[]],[\"title/references/FluxTraining.Loggables.Audio\",[129,4.873]],[\"body/references/FluxTraining.Loggables.Audio\",[]],[\"title/references/FluxTraining.LogHyperParams\",[130,4.873]],[\"body/references/FluxTraining.LogHyperParams\",[]],[\"title/references/FluxTraining.History\",[131,4.873]],[\"body/references/FluxTraining.History\",[]],[\"title/documents/docs/imagenette_demo.ipynb\",[132,4.873]],[\"body/documents/docs/imagenette_demo.ipynb\",[]],[\"title/references/FluxTraining.Scheduler\",[16,4.341]],[\"body/references/FluxTraining.Scheduler\",[]],[\"title/references/FluxTraining.Phases.TrainingPhase\",[133,4.873]],[\"body/references/FluxTraining.Phases.TrainingPhase\",[]],[\"title/documents/docs/background/model.md\",[81,4.341]],[\"body/documents/docs/background/model.md\",[]],[\"title/references/FluxTraining.fit!\",[134,4.873]],[\"body/references/FluxTraining.fit!\",[]],[\"title/references/FluxTraining.SanityCheckException\",[135,4.873]],[\"body/references/FluxTraining.SanityCheckException\",[]],[\"title/references/FluxTraining.Checkpointer\",[136,4.873]],[\"body/references/FluxTraining.Checkpointer\",[]],[\"title/references/FluxTraining.Loggables.Image\",[65,4.341]],[\"body/references/FluxTraining.Loggables.Image\",[]],[\"title/references/FluxTraining.Events.BackwardEnd\",[137,4.873]],[\"body/references/FluxTraining.Events.BackwardEnd\",[]],[\"title/references/FluxTraining.UnsafeCallback\",[138,4.873]],[\"body/references/FluxTraining.UnsafeCallback\",[]],[\"title/references/FluxTraining.CustomCallback\",[139,4.873]],[\"body/references/FluxTraining.CustomCallback\",[]],[\"title/references/FluxTraining.CancelEpochException\",[140,4.873]],[\"body/references/FluxTraining.CancelEpochException\",[]],[\"title/documents/docs/callbacks/custom.md\",[12,2.542,54,3.134]],[\"body/documents/docs/callbacks/custom.md\",[]],[\"title/references/FluxTraining.CheckDataIteratorValid\",[141,4.873]],[\"body/references/FluxTraining.CheckDataIteratorValid\",[]],[\"title/references/FluxTraining.errorwriteconflict\",[142,4.873]],[\"body/references/FluxTraining.errorwriteconflict\",[]],[\"title/references/FluxTraining.Permission\",[143,4.873]],[\"body/references/FluxTraining.Permission\",[]],[\"title/references/FluxTraining.Loggables.Value\",[144,4.873]],[\"body/references/FluxTraining.Loggables.Value\",[]],[\"title/references/FluxTraining.runstep\",[145,4.873]],[\"body/references/FluxTraining.runstep\",[]],[\"title/references/FluxTraining.Loggables.Histogram\",[146,4.873]],[\"body/references/FluxTraining.Loggables.Histogram\",[]],[\"title/references/FluxTraining.TestModel\",[147,4.873]],[\"body/references/FluxTraining.TestModel\",[]],[\"title/references/FluxTraining.ToGPU\",[148,4.873]],[\"body/references/FluxTraining.ToGPU\",[]],[\"title/references/FluxTraining.LoggerBackend\",[149,4.873]],[\"body/references/FluxTraining.LoggerBackend\",[]],[\"title/documents/docs/background/dataiterator.md\",[150,3.518,151,3.518]],[\"body/documents/docs/background/dataiterator.md\",[]]],\"invertedIndex\":[[\"\",{\"_index\":93,\"title\":{\"documents/docs/callbacks/tipstricks.md\":{}},\"body\":{}}],[\"abstractcallback\",{\"_index\":34,\"title\":{\"references/FluxTraining.AbstractCallback\":{}},\"body\":{}}],[\"abstractmetr\",{\"_index\":59,\"title\":{\"references/FluxTraining.AbstractMetric\":{}},\"body\":{}}],[\"abstracttrainingphas\",{\"_index\":61,\"title\":{\"references/FluxTraining.Phases.AbstractTrainingPhase\":{}},\"body\":{}}],[\"abstractvalidationphas\",{\"_index\":97,\"title\":{\"references/FluxTraining.Phases.AbstractValidationPhase\":{}},\"body\":{}}],[\"access\",{\"_index\":88,\"title\":{\"references/FluxTraining.accesses\":{}},\"body\":{}}],[\"accuraci\",{\"_index\":4,\"title\":{\"references/FluxTraining.accuracy\":{}},\"body\":{}}],[\"addcallback\",{\"_index\":13,\"title\":{\"references/FluxTraining.addcallback!\":{}},\"body\":{}}],[\"api\",{\"_index\":68,\"title\":{\"documents/docs/reference/training.md\":{}},\"body\":{}}],[\"audio\",{\"_index\":129,\"title\":{\"references/FluxTraining.Loggables.Audio\":{}},\"body\":{}}],[\"backwardbegin\",{\"_index\":21,\"title\":{\"references/FluxTraining.Events.BackwardBegin\":{}},\"body\":{}}],[\"backwardend\",{\"_index\":137,\"title\":{\"references/FluxTraining.Events.BackwardEnd\":{}},\"body\":{}}],[\"callback\",{\"_index\":12,\"title\":{\"references/FluxTraining.Callbacks\":{},\"references/FluxTraining.Callback\":{},\"documents/docs/callbacks/reference.md\":{},\"documents/docs/callbacks/usage.md\":{},\"documents/docs/callbacks/custom.md\":{}},\"body\":{}}],[\"callbackcondit\",{\"_index\":91,\"title\":{\"references/FluxTraining.CallbackCondition\":{}},\"body\":{}}],[\"callbackgraph\",{\"_index\":33,\"title\":{\"references/FluxTraining.callbackgraph\":{}},\"body\":{}}],[\"callbackrunn\",{\"_index\":7,\"title\":{\"references/FluxTraining.CallbackRunner\":{}},\"body\":{}}],[\"cancelepochexcept\",{\"_index\":140,\"title\":{\"references/FluxTraining.CancelEpochException\":{}},\"body\":{}}],[\"cancelfittingexcept\",{\"_index\":99,\"title\":{\"references/FluxTraining.CancelFittingException\":{}},\"body\":{}}],[\"cancelstepexcept\",{\"_index\":6,\"title\":{\"references/FluxTraining.CancelStepException\":{}},\"body\":{}}],[\"check\",{\"_index\":8,\"title\":{\"references/FluxTraining.Check\":{},\"references/FluxTraining.CHECKS\":{}},\"body\":{}}],[\"checkdataiteratortrain\",{\"_index\":14,\"title\":{\"references/FluxTraining.CheckDataIteratorTrain\":{}},\"body\":{}}],[\"checkdataiteratorvalid\",{\"_index\":141,\"title\":{\"references/FluxTraining.CheckDataIteratorValid\":{}},\"body\":{}}],[\"checkiteratestupl\",{\"_index\":17,\"title\":{\"references/FluxTraining.CheckIteratesTuples\":{}},\"body\":{}}],[\"checkmodellossstep\",{\"_index\":5,\"title\":{\"references/FluxTraining.CheckModelLossStep\":{}},\"body\":{}}],[\"checkpoint\",{\"_index\":136,\"title\":{\"references/FluxTraining.Checkpointer\":{}},\"body\":{}}],[\"classifi\",{\"_index\":66,\"title\":{\"documents/docs/tutorials/mnist.ipynb\":{}},\"body\":{}}],[\"conditionalcallback\",{\"_index\":126,\"title\":{\"references/FluxTraining.ConditionalCallback\":{}},\"body\":{}}],[\"conflictresolut\",{\"_index\":9,\"title\":{\"references/FluxTraining.ConflictResolution\":{}},\"body\":{}}],[\"custom\",{\"_index\":54,\"title\":{\"documents/docs/custom_training.ipynb\":{},\"documents/docs/callbacks/custom.md\":{}},\"body\":{}}],[\"customcallback\",{\"_index\":139,\"title\":{\"references/FluxTraining.CustomCallback\":{}},\"body\":{}}],[\"data\",{\"_index\":150,\"title\":{\"documents/docs/background/dataiterator.md\":{}},\"body\":{}}],[\"defaultcallback\",{\"_index\":86,\"title\":{\"references/FluxTraining.defaultcallbacks\":{}},\"body\":{}}],[\"earlystop\",{\"_index\":23,\"title\":{\"references/FluxTraining.EarlyStopping\":{}},\"body\":{}}],[\"edgesrunaft\",{\"_index\":72,\"title\":{\"references/FluxTraining.edgesrunafter\":{}},\"body\":{}}],[\"epoch\",{\"_index\":60,\"title\":{\"references/FluxTraining.epoch!\":{}},\"body\":{}}],[\"epochbegin\",{\"_index\":82,\"title\":{\"references/FluxTraining.Events.EpochBegin\":{}},\"body\":{}}],[\"epochend\",{\"_index\":29,\"title\":{\"references/FluxTraining.Events.EpochEnd\":{}},\"body\":{}}],[\"epochvalu\",{\"_index\":44,\"title\":{\"references/FluxTraining.epochvalue\":{}},\"body\":{}}],[\"errorwriteconflict\",{\"_index\":142,\"title\":{\"references/FluxTraining.errorwriteconflict\":{}},\"body\":{}}],[\"es\",{\"_index\":106,\"title\":{\"references/FluxTraining.ES\":{}},\"body\":{}}],[\"event\",{\"_index\":83,\"title\":{\"references/FluxTraining.Events\":{},\"references/FluxTraining.Events.Event\":{}},\"body\":{}}],[\"featur\",{\"_index\":36,\"title\":{\"documents/docs/features.md\":{}},\"body\":{}}],[\"file\",{\"_index\":71,\"title\":{\"references/FluxTraining.Loggables.File\":{}},\"body\":{}}],[\"findconflict\",{\"_index\":103,\"title\":{\"references/FluxTraining.findconflicts\":{}},\"body\":{}}],[\"fit\",{\"_index\":134,\"title\":{\"references/FluxTraining.fit!\":{}},\"body\":{}}],[\"fitexcept\",{\"_index\":22,\"title\":{\"references/FluxTraining.FitException\":{}},\"body\":{}}],[\"fluxtrain\",{\"_index\":77,\"title\":{\"references/FluxTraining\":{}},\"body\":{}}],[\"fluxtraining.jl\",{\"_index\":70,\"title\":{\"documents/README.md\":{}},\"body\":{}}],[\"formataccess\",{\"_index\":79,\"title\":{\"references/FluxTraining.formataccess\":{}},\"body\":{}}],[\"frequencythrottl\",{\"_index\":114,\"title\":{\"references/FluxTraining.FrequencyThrottle\":{}},\"body\":{}}],[\"function\",{\"_index\":25,\"title\":{\"documents/docs/background/lossfunction.md\":{}},\"body\":{}}],[\"garbagecollect\",{\"_index\":48,\"title\":{\"references/FluxTraining.garbagecollect\":{},\"references/FluxTraining.GarbageCollect\":{}},\"body\":{}}],[\"get\",{\"_index\":46,\"title\":{\"documents/docs/getting_started.md\":{},\"documents/docs/overview.md\":{}},\"body\":{}}],[\"getcallback\",{\"_index\":118,\"title\":{\"references/FluxTraining.getcallback\":{}},\"body\":{}}],[\"getfieldperm\",{\"_index\":62,\"title\":{\"references/FluxTraining.getfieldperm\":{}},\"body\":{}}],[\"getindexperm\",{\"_index\":38,\"title\":{\"references/FluxTraining.getindexperm\":{}},\"body\":{}}],[\"graph\",{\"_index\":74,\"title\":{\"references/FluxTraining.Loggables.Graph\":{}},\"body\":{}}],[\"handl\",{\"_index\":121,\"title\":{\"references/FluxTraining.handle\":{}},\"body\":{}}],[\"hasconflict\",{\"_index\":110,\"title\":{\"references/FluxTraining.hasconflict\":{}},\"body\":{}}],[\"histogram\",{\"_index\":146,\"title\":{\"references/FluxTraining.Loggables.Histogram\":{}},\"body\":{}}],[\"histori\",{\"_index\":131,\"title\":{\"references/FluxTraining.History\":{}},\"body\":{}}],[\"hyperparamet\",{\"_index\":1,\"title\":{\"references/FluxTraining.HyperParameter\":{},\"documents/docs/tutorials/hyperparameters.md\":{}},\"body\":{}}],[\"imag\",{\"_index\":65,\"title\":{\"documents/docs/tutorials/mnist.ipynb\":{},\"references/FluxTraining.Loggables.Image\":{}},\"body\":{}}],[\"imagenette_demo\",{\"_index\":132,\"title\":{\"documents/docs/imagenette_demo.ipynb\":{}},\"body\":{}}],[\"init\",{\"_index\":50,\"title\":{\"references/FluxTraining.init!\":{}},\"body\":{}}],[\"iter\",{\"_index\":151,\"title\":{\"documents/docs/background/dataiterator.md\":{}},\"body\":{}}],[\"iterpair\",{\"_index\":45,\"title\":{\"references/FluxTraining.iterpairs\":{}},\"body\":{}}],[\"learner\",{\"_index\":89,\"title\":{\"references/FluxTraining.Learner\":{}},\"body\":{}}],[\"learningr\",{\"_index\":15,\"title\":{\"references/FluxTraining.LearningRate\":{}},\"body\":{}}],[\"licens\",{\"_index\":58,\"title\":{\"documents/LICENSE.md\":{}},\"body\":{}}],[\"linearrunn\",{\"_index\":75,\"title\":{\"references/FluxTraining.LinearRunner\":{}},\"body\":{}}],[\"loadmodel\",{\"_index\":100,\"title\":{\"references/FluxTraining.loadmodel\":{}},\"body\":{}}],[\"log_paramet\",{\"_index\":80,\"title\":{\"references/FluxTraining.log_parameters\":{}},\"body\":{}}],[\"log_to\",{\"_index\":32,\"title\":{\"references/FluxTraining.log_to\":{}},\"body\":{}}],[\"loggabl\",{\"_index\":87,\"title\":{\"references/FluxTraining.Loggables\":{},\"references/FluxTraining.Loggables.Loggable\":{}},\"body\":{}}],[\"loggerbackend\",{\"_index\":149,\"title\":{\"references/FluxTraining.LoggerBackend\":{}},\"body\":{}}],[\"loghistogram\",{\"_index\":40,\"title\":{\"references/FluxTraining.LogHistograms\":{}},\"body\":{}}],[\"loghyperparam\",{\"_index\":130,\"title\":{\"references/FluxTraining.LogHyperParams\":{}},\"body\":{}}],[\"logmetr\",{\"_index\":127,\"title\":{\"references/FluxTraining.LogMetrics\":{}},\"body\":{}}],[\"logvisu\",{\"_index\":78,\"title\":{\"references/FluxTraining.LogVisualization\":{}},\"body\":{}}],[\"loop\",{\"_index\":56,\"title\":{\"documents/docs/custom_training.ipynb\":{},\"documents/docs/reference/training.md\":{},\"documents/docs/tutorials/training.md\":{}},\"body\":{}}],[\"loss\",{\"_index\":24,\"title\":{\"references/FluxTraining.Loss\":{},\"documents/docs/background/lossfunction.md\":{}},\"body\":{}}],[\"lossbegin\",{\"_index\":119,\"title\":{\"references/FluxTraining.Events.LossBegin\":{}},\"body\":{}}],[\"metric\",{\"_index\":18,\"title\":{\"references/FluxTraining.Metric\":{},\"references/FluxTraining.Metrics\":{}},\"body\":{}}],[\"metricnam\",{\"_index\":102,\"title\":{\"references/FluxTraining.metricname\":{}},\"body\":{}}],[\"metricsprint\",{\"_index\":109,\"title\":{\"references/FluxTraining.MetricsPrinter\":{}},\"body\":{}}],[\"model\",{\"_index\":81,\"title\":{\"references/FluxTraining.model!\":{},\"documents/docs/background/model.md\":{}},\"body\":{}}],[\"new\",{\"_index\":0,\"title\":{\"documents/CHANGELOG.md\":{}},\"body\":{}}],[\"noconflict\",{\"_index\":84,\"title\":{\"references/FluxTraining.NoConflict\":{}},\"body\":{}}],[\"notdefin\",{\"_index\":101,\"title\":{\"references/FluxTraining.NotDefined\":{}},\"body\":{}}],[\"onecycl\",{\"_index\":98,\"title\":{\"references/FluxTraining.onecycle\":{}},\"body\":{}}],[\"optim\",{\"_index\":41,\"title\":{\"documents/docs/background/optimizer.md\":{}},\"body\":{}}],[\"permiss\",{\"_index\":143,\"title\":{\"references/FluxTraining.Permission\":{}},\"body\":{}}],[\"phase\",{\"_index\":35,\"title\":{\"references/FluxTraining.Phases\":{},\"references/FluxTraining.Phases.Phase\":{}},\"body\":{}}],[\"phasedatait\",{\"_index\":20,\"title\":{\"references/FluxTraining.phasedataiter\":{}},\"body\":{}}],[\"print_epoch_t\",{\"_index\":30,\"title\":{\"references/FluxTraining.print_epoch_table\":{}},\"body\":{}}],[\"progressprint\",{\"_index\":113,\"title\":{\"references/FluxTraining.ProgressPrinter\":{}},\"body\":{}}],[\"propdict\",{\"_index\":108,\"title\":{\"references/FluxTraining.PropDict\":{}},\"body\":{}}],[\"protect\",{\"_index\":53,\"title\":{\"references/FluxTraining.Protected\":{},\"references/FluxTraining.protect\":{}},\"body\":{}}],[\"protectedexcept\",{\"_index\":111,\"title\":{\"references/FluxTraining.ProtectedException\":{}},\"body\":{}}],[\"read\",{\"_index\":105,\"title\":{\"references/FluxTraining.Read\":{}},\"body\":{}}],[\"record\",{\"_index\":124,\"title\":{\"references/FluxTraining.Recorder\":{}},\"body\":{}}],[\"refer\",{\"_index\":69,\"title\":{\"documents/docs/reference/training.md\":{},\"documents/docs/callbacks/reference.md\":{}},\"body\":{}}],[\"removecallback\",{\"_index\":3,\"title\":{\"references/FluxTraining.removecallback!\":{}},\"body\":{}}],[\"replacecallback\",{\"_index\":10,\"title\":{\"references/FluxTraining.replacecallback!\":{}},\"body\":{}}],[\"reset\",{\"_index\":19,\"title\":{\"references/FluxTraining.reset!\":{}},\"body\":{}}],[\"resolveconflict\",{\"_index\":85,\"title\":{\"references/FluxTraining.resolveconflict\":{}},\"body\":{}}],[\"runaft\",{\"_index\":107,\"title\":{\"references/FluxTraining.runafter\":{}},\"body\":{}}],[\"runcheck\",{\"_index\":116,\"title\":{\"references/FluxTraining.runchecks\":{}},\"body\":{}}],[\"runepoch\",{\"_index\":26,\"title\":{\"references/FluxTraining.runepoch\":{}},\"body\":{}}],[\"runfirst\",{\"_index\":117,\"title\":{\"references/FluxTraining.RunFirst\":{}},\"body\":{}}],[\"runstep\",{\"_index\":145,\"title\":{\"references/FluxTraining.runstep\":{}},\"body\":{}}],[\"runtest\",{\"_index\":73,\"title\":{\"references/FluxTraining.runtests\":{}},\"body\":{}}],[\"safecallback\",{\"_index\":128,\"title\":{\"references/FluxTraining.SafeCallback\":{}},\"body\":{}}],[\"sanitycheck\",{\"_index\":122,\"title\":{\"references/FluxTraining.SanityCheck\":{}},\"body\":{}}],[\"sanitycheckexcept\",{\"_index\":135,\"title\":{\"references/FluxTraining.SanityCheckException\":{}},\"body\":{}}],[\"savemodel\",{\"_index\":2,\"title\":{\"references/FluxTraining.savemodel\":{}},\"body\":{}}],[\"schedul\",{\"_index\":16,\"title\":{\"documents/docs/tutorials/hyperparameters.md\":{},\"references/FluxTraining.Scheduler\":{}},\"body\":{}}],[\"setcallback\",{\"_index\":67,\"title\":{\"references/FluxTraining.setcallbacks!\":{}},\"body\":{}}],[\"setfieldperm\",{\"_index\":52,\"title\":{\"references/FluxTraining.setfieldperm!\":{}},\"body\":{}}],[\"sethyperparamet\",{\"_index\":27,\"title\":{\"references/FluxTraining.sethyperparameter!\":{}},\"body\":{}}],[\"setindexperm\",{\"_index\":90,\"title\":{\"references/FluxTraining.setindexperm!\":{}},\"body\":{}}],[\"setlearningr\",{\"_index\":95,\"title\":{\"references/FluxTraining.setlearningrate!\":{}},\"body\":{}}],[\"setupoptimst\",{\"_index\":31,\"title\":{\"references/FluxTraining.setupoptimstate\":{}},\"body\":{}}],[\"shouldrun\",{\"_index\":49,\"title\":{\"references/FluxTraining.shouldrun\":{}},\"body\":{}}],[\"smoothloss\",{\"_index\":63,\"title\":{\"references/FluxTraining.SmoothLoss\":{}},\"body\":{}}],[\"start\",{\"_index\":47,\"title\":{\"documents/docs/getting_started.md\":{},\"documents/docs/overview.md\":{}},\"body\":{}}],[\"stateaccess\",{\"_index\":64,\"title\":{\"references/FluxTraining.stateaccess\":{}},\"body\":{}}],[\"step\",{\"_index\":112,\"title\":{\"references/FluxTraining.step!\":{}},\"body\":{}}],[\"stepbegin\",{\"_index\":57,\"title\":{\"references/FluxTraining.Events.StepBegin\":{}},\"body\":{}}],[\"stepend\",{\"_index\":120,\"title\":{\"references/FluxTraining.Events.StepEnd\":{}},\"body\":{}}],[\"stepvalu\",{\"_index\":96,\"title\":{\"references/FluxTraining.stepvalue\":{}},\"body\":{}}],[\"stoponnanloss\",{\"_index\":51,\"title\":{\"references/FluxTraining.StopOnNaNLoss\":{}},\"body\":{}}],[\"tensorboardbackend\",{\"_index\":37,\"title\":{\"references/FluxTraining.TensorBoardBackend\":{}},\"body\":{}}],[\"testbatch\",{\"_index\":39,\"title\":{\"references/FluxTraining.testbatch\":{},\"references/FluxTraining.testbatches\":{}},\"body\":{}}],[\"testlearn\",{\"_index\":42,\"title\":{\"references/FluxTraining.testlearner\":{}},\"body\":{}}],[\"testmodel\",{\"_index\":147,\"title\":{\"references/FluxTraining.TestModel\":{}},\"body\":{}}],[\"text\",{\"_index\":104,\"title\":{\"references/FluxTraining.Loggables.Text\":{}},\"body\":{}}],[\"throttl\",{\"_index\":11,\"title\":{\"references/FluxTraining.throttle\":{}},\"body\":{}}],[\"timethrottl\",{\"_index\":123,\"title\":{\"references/FluxTraining.TimeThrottle\":{}},\"body\":{}}],[\"tip\",{\"_index\":92,\"title\":{\"documents/docs/callbacks/tipstricks.md\":{}},\"body\":{}}],[\"todevic\",{\"_index\":125,\"title\":{\"references/FluxTraining.ToDevice\":{}},\"body\":{}}],[\"togpu\",{\"_index\":148,\"title\":{\"references/FluxTraining.ToGPU\":{}},\"body\":{}}],[\"train\",{\"_index\":55,\"title\":{\"documents/docs/custom_training.ipynb\":{},\"documents/docs/tutorials/mnist.ipynb\":{},\"documents/docs/reference/training.md\":{},\"documents/docs/tutorials/training.md\":{}},\"body\":{}}],[\"trainingphas\",{\"_index\":133,\"title\":{\"references/FluxTraining.Phases.TrainingPhase\":{}},\"body\":{}}],[\"trick\",{\"_index\":94,\"title\":{\"documents/docs/callbacks/tipstricks.md\":{}},\"body\":{}}],[\"unresolv\",{\"_index\":76,\"title\":{\"references/FluxTraining.Unresolvable\":{}},\"body\":{}}],[\"unsafecallback\",{\"_index\":138,\"title\":{\"references/FluxTraining.UnsafeCallback\":{}},\"body\":{}}],[\"us\",{\"_index\":115,\"title\":{\"documents/docs/callbacks/usage.md\":{}},\"body\":{}}],[\"validationphas\",{\"_index\":43,\"title\":{\"references/FluxTraining.Phases.ValidationPhase\":{}},\"body\":{}}],[\"valu\",{\"_index\":144,\"title\":{\"references/FluxTraining.Loggables.Value\":{}},\"body\":{}}],[\"write\",{\"_index\":28,\"title\":{\"references/FluxTraining.Write\":{}},\"body\":{}}]],\"pipeline\":[\"stemmer\"]}"}</script>
	<script type="application/json" sveltekit:data-type="data" sveltekit:data-url="/FluxTraining.jl/api/dev/documents/docs/custom_training.ipynb.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"attributes\":{\"backlinks\":[],\"path\":\"/home/runner/.julia/packages/FluxTraining/xKIuJ/docs/custom_training.ipynb\",\"title\":\"Custom training loops\"},\"tag\":\"document\",\"children\":[{\"attributes\":{\"nbformat\":[4,4],\"kernelspec\":{\"display_name\":\"Julia (12 threads) 1.5.0\",\"language\":\"julia\",\"name\":\"julia-(12-threads)-1.5\"},\"language_info\":{\"file_extension\":\".jl\",\"mimetype\":\"application/julia\",\"name\":\"julia\",\"version\":\"1.5.0\"}},\"tag\":\"jupyter\",\"children\":[{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"h1\",\"children\":[\"Custom training loops\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"How can we compose changes to the training loop together?\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"As an example, we want to be able to do data-parallel training or GAN training, but also data-parallel GAN training.\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"I want to give some thoughts on this and propose possible solutions to make this possible in \",{\"attributes\":{},\"tag\":\"em\",\"children\":[\"FastAI.jl\"],\"type\":\"node\"},\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Currently, implementing custom training behavior is possible by subtyping \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"FitPhase\"],\"type\":\"node\"},\" and implementing \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"fitbatchphase!(learner, phase::MyPhase)\"],\"type\":\"node\"},\". However, this is not composable, i.e. it doesn't allow you to combine a \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"DataParallelTrainingPhase\"],\"type\":\"node\"},\" and \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"GANTrainingPhase\"],\"type\":\"node\"},\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Below are some examples that show how the contents of \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"fitbatchphase!\"],\"type\":\"node\"},\" can be changed to illustrate this. For simplicity, they don't include callbacks and state handling.\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"h4\",\"children\":[\"Regular training (1)\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null,\"execution_count\":8},\"tag\":\"codecell\",\"children\":[{\"attributes\":{},\"tag\":\"codeinput\",\"children\":[{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# inputs: model, xs, ys, lossfn, optim, params\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"gradient\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[\"return\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"lossfn\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"update!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"optim\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"sum\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"h4\",\"children\":[\"Data-parallel training on CPU (2)\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null,\"execution_count\":null},\"tag\":\"codecell\",\"children\":[{\"attributes\":{},\"tag\":\"codeinput\",\"children\":[{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# inputs: model, xs, ys, lossfn, optim, params\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"CURLY\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Array\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LBRACE\",\"children\":[\"{\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RBRACE\",\"children\":[\"}\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"undef\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Threads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"nthreads\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# run equally-sized slices of the batch in parallel (naive pseudocode)\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"MACROCALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Threads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"AT_SIGN\",\"children\":[\"@\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"MACRO_NAME\",\"children\":[\"threads\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"FOR\",\"children\":[{\"attributes\":{},\"tag\":\"FOR\",\"children\":[\"for\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"i\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs_\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys_\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IN\",\"children\":[\"in\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"enumerate\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"scatter\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Threads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"nthreads\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"REF\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LSQUARE\",\"children\":[\"[\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"i\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RSQUARE\",\"children\":[\"]\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"gradient\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[\"return\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"lossfn\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs_\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys_\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"gs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"sum\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# do parameter update with summed gradients\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"update!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"optim\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"gs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"h4\",\"children\":[\"GAN training (3)\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null,\"execution_count\":null},\"tag\":\"codecell\",\"children\":[{\"attributes\":{},\"tag\":\"codeinput\",\"children\":[{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# inputs: mgen, mcrit, paramsgen, paramscrit, xs_true, lossfngen, lossfncrit, optim, batchsize\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# critic step\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs_fake\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"mgen\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batchsize\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"cat\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs_true\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs_fake\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"onehot\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"vcat\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"trues\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batchsize\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"falses\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batchsize\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"gradient\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"paramscrit\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[\"return\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"lossfncrit\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"mcrit\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"update!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"optim\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"paramscrit\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# generator step\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"gradient\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"paramsgen\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs_fake\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"mgen\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batchsize\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys_fake\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"onehot\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"falses\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batchsize\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[\"return\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"MINUS\",\"children\":[\"-\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"lossfncrit\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"crit\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs_fake\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys_fake\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"h3\",\"children\":[\"Solutions\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"I have found two approaches to deal with this. \",{\"attributes\":{},\"tag\":\"strong\",\"children\":[\"Both focus on removing execution logic from \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"fitbatchphase!\"],\"type\":\"node\"},\", making them composable with custom \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Phase\"],\"type\":\"node\"},\"s\"],\"type\":\"node\"},\" like \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"GANTrainingPhase\"],\"type\":\"node\"},\" that change\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"the \",{\"attributes\":{},\"tag\":\"em\",\"children\":[\"semantics\"],\"type\":\"node\"},\" of the training loop.\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"On one hand, there are extensions to the training loop that change the \",{\"attributes\":{},\"tag\":\"em\",\"children\":[\"execution\"],\"type\":\"node\"},\" (e.g. parallel and distributed CPU and GPU training), on the other hand you have those that change the \",{\"attributes\":{},\"tag\":\"em\",\"children\":[\"semantics\"],\"type\":\"node\"},\" (e.g. GAN training).\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"The proposed solutions make the assumption that different \",{\"attributes\":{},\"tag\":\"em\",\"children\":[\"semantics\"],\"type\":\"node\"},\" don't need to be composed, but should be composable with different execution contexts.\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"h4\",\"children\":[\"(S1) Abstract gradient step (and possibly others) out\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Modifications to the execution of the training loop could be implemented by wrapping in an execution context.\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"In the below example \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"gradientphase\"],\"type\":\"node\"},\" could dispatch to the regular gradient calculation in (1) or the data-parallel approach (2) depending on \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"executionctx\"],\"type\":\"node\"},\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"This would mean that only \",{\"attributes\":{},\"tag\":\"em\",\"children\":[\"semantic\"],\"type\":\"node\"},\" changes to the training loop would use overloading of \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"fitbatchphase!\"],\"type\":\"node\"},\" with a custom \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"FitPhase\"],\"type\":\"node\"},\". Changes to the \",{\"attributes\":{},\"tag\":\"em\",\"children\":[\"execution\"],\"type\":\"node\"},\" work by dispatching on execution contexts, e.g. \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"gradientphase(::Linear, ...)\"],\"type\":\"node\"},\" or \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"gradientphase(::DataParallel, ...)\"],\"type\":\"node\"},\".\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null,\"execution_count\":null},\"tag\":\"codecell\",\"children\":[{\"attributes\":{},\"tag\":\"codeinput\",\"children\":[{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# gradientphase passes (possibly modified) state to a closure\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# in the case executionctx::DataParallel, xs_, ys_ will be slices\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# of the batch.\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"gradient\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"executionctx\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model_\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params_\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs_\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys_\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\" \\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[\"return\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"lossfn\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs_\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys_\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"update!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"optim\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[{\"attributes\":{},\"tag\":\"strong\",\"children\":[\"Advantages\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ul\",\"children\":[{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"implementation definitely doable\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[{\"attributes\":{},\"tag\":\"strong\",\"children\":[\"Disadvantages\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ul\",\"children\":[{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"implementation dependent on requirements, i.e. unsure which pieces of the training step need to be overloadable and which state needs to be passed to closures.\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"h4\",\"children\":[\"(S2) Wrapper for \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"model\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"The idea is to wrap the \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"model\"],\"type\":\"node\"},\" in an execution context, e.g. \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"DataParallel(model)\"],\"type\":\"node\"},\". The wrapper is then responsible for exhibiting the correct behavior on the forward and backward pass. This is \",{\"attributes\":{\"href\":\"https://pytorch.org/docs/stable/generated/torch.nn.DataParallel.html?highlight=parallel#torch.nn.DataParallel\",\"title\":\"\"},\"tag\":\"a\",\"children\":[\"what PyTorch does\"],\"type\":\"node\"},\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"No changes to the training loop would need to be made. The implementation for the forward pass should be straightforward and similar to the above sketch (2), however I'm not sure how to make sure that the backward pass is also computed in parallel (can custom gradient definitions include multi-threading code?, what about the loss function that is not wrapped?).\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null,\"execution_count\":null},\"tag\":\"codecell\",\"children\":[{\"attributes\":{},\"tag\":\"codeinput\",\"children\":[{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# before training\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"DataParallel\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# training step doesn't change at all\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"gradient\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[\"return\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"lossfn\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"update!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"optim\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"sum\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[{\"attributes\":{},\"tag\":\"strong\",\"children\":[\"Advantages\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ul\",\"children\":[{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"no changes needed to state and event handling\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[{\"attributes\":{},\"tag\":\"strong\",\"children\":[\"Disadvantages\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ul\",\"children\":[{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"not sure if such a simple API is possible to implement for all scenarios\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"bit unelegant; model is not a pure function anymore\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}"}</script></div>
</body>

</html>